sampling solve may throw exception due to val link